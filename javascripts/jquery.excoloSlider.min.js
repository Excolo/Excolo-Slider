/*!
 * Excolo Slider - A simple jquery slider
 *
 * Examples and documentation at:
 * http://excolo.github.io/Excolo-Slider/
 *
 * Author: Nikolaj Dam Larsen
 * Version: 0.4.0 (13-JUNE-2013)
 *
 * Released under the MIT license
 * https://github.com/Excolo/ExcoloSlider/blob/master/MIT-LICENSE
 */
;(function(f,d,a,g){var b,e,c;b="0.4.0";e="excoloSlider";c=(function(){function h(j,i){this.elem=j;this.$elem=f(j);this.options=i;this.metadata=this.$elem.data("plugin-options")}return h})();c.prototype={defaults:{width:800,height:530,autoSize:true,keyboardNav:true,touchNav:true,mouseNav:true,prevnextNav:true,prevnextAutoHide:true,startSlide:1,autoPlay:true,delay:0,interval:3000,repeat:true,playReverse:false,hoverPause:true,captionAutoHide:false,animationCssTransitions:true,animationDuration:500,animationTimingFunction:"linear",prevButtonClass:"slide-prev",nextButtonClass:"slide-next",prevButtonImage:"images/prev.png",nextButtonImage:"images/next.png",activeSlideClass:"es-active",slideCaptionClass:"es-caption"},init:function(){var o,n,l,h,m,k,j,i;o=this;o.config=f.extend({},o.defaults,o.options,o.metadata);o.data=f.data(o);f.data(o,"currentSlide",o.config.playReverse&&o.config.startSlide==1?o.$elem.children().length-1:o.config.startSlide-1);f.data(o,"nextSlide",o.data.currentSlide);f.data(o,"totalslides",o.$elem.children().length);f.data(o,"browserEnginePrefix",o._getBrowserEnginePrefix());f.data(o,"isPlaying",false);f.data(o,"isAnimating",false);f.data(o,"playPaused",false);f.data(o,"justTouched",false);f.data(o,"isMoving",false);f.data(o,"width",o.config.width);o.$elem.addClass("slider");o.$elem.css({position:"relative"});o.$elem.wrapInner("<div class='slide-wrapper'>",o.$elem).children();o.$elem.wrapInner("<div class='slide-container'>",f(".slide-wrapper",o.$elem)).children();f(".slide-container",o.$elem).css({position:"relative"});if(o.config.prevnextNav){f(".slide-wrapper",o.$elem).after("<div class='"+o.config.nextButtonClass+"'>");f(".slide-wrapper",o.$elem).after("<div class='"+o.config.prevButtonClass+"'>");h=f("."+o.config.nextButtonClass,o.$elem);l=f("."+o.config.prevButtonClass,o.$elem);h.append("<img src='"+o.config.nextButtonImage+"'>");l.append("<img src='"+o.config.prevButtonImage+"'>");m=h.add(l);if(o.config.prevnextAutoHide){m.hide();o.$elem.hover(function(){m.fadeIn("fast")},function(){m.fadeOut("fast")})}l.on("click",function(p){o.previous()});h.on("click",function(p){o.next()})}i=f(".slide-wrapper",o.$elem).children();i.each(function(){k=f(this);j=k.data("plugin-slide-caption");if(j===g){return}if(this.tagName=="IMG"){k.wrap("<div>");k.after("<div class='"+o.config.slideCaptionClass+"'>");k.next().append(j)}else{k.append("<div class='"+o.config.slideCaptionClass+"'>");k.children().last().append(j)}if(o.config.captionAutoHide){f("."+o.config.slideCaptionClass,o.$elem).hide();o.$elem.hover(function(){f("."+o.config.slideCaptionClass,o.$elem).fadeIn("fast")},function(){f("."+o.config.slideCaptionClass,o.$elem).fadeOut("fast")})}});f(".slide-wrapper",o.$elem).children().addClass("slide").css({position:"absolute",top:0,left:0,width:o.data.width,height:o.config.height,zIndex:0,display:"none",webkitBackfaceVisibility:"hidden"});n=i.height();f(".slide-wrapper",o.$elem).css({position:"relative",left:0,height:n});f(".slide-container",o.$elem).css({width:o.data.width,overflow:"hidden",height:n});if(o.config.touchNav){o.$elem.on("touchstart",function(q){var p=q.originalEvent.touches[0];q.preventDefault();o._onMoveStart(p.pageX,p.pageY);return q.stopPropagation()});o.$elem.on("touchmove",function(q){var p=q.originalEvent.touches[0];q.preventDefault();o._onMove(p.pageX,p.pageY);return q.stopPropagation()});o.$elem.on("touchend",function(p){p.preventDefault();o._onMoveEnd();return p.stopPropagation()})}if(o.config.mouseNav){o.$elem.css("cursor","pointer");o.$elem.on("dragstart",function(p){return false});o.$elem.on("mousedown",function(p){o._onMoveStart(p.clientX,p.clientY);f(d).attr("unselectable","on").on("selectstart",false).css("user-select","none").css("UserSelect","none").css("MozUserSelect","none");return p.stopPropagation()});f(d).on("mousemove",function(p){o._onMove(p.clientX,p.clientY);return p.stopPropagation()});f(d).on("mouseup",function(p){o._onMoveEnd();f(d).removeAttr("unselectable").unbind("selectstart").css("user-select",null).css("UserSelect",null).css("MozUserSelect",null);return p.stopPropagation()})}if(o.config.keyboardNav){f(d).keydown(function(p){return o._onKeyboardNav(p)})}if(o.config.autoSize){setTimeout(function(){o._resize()},50);f(d).resize(function(){return setTimeout(function(){o._resize()},50)})}o._prepareslides();o.gotoSlide(o.data.currentSlide);if(o.config.autoPlay){setTimeout(function(){o.start()},o.config.delay)}return this},previous:function(){var h,i;h=this;f.data(h,"slideDirection","previous");i=(h.data.nextSlide-1)%h.data.totalslides;if(!h.config.repeat&&(h.data.nextSlide-1)<0){if(h.config.playReverse){f.data(h,"playPaused",true);h.stop()}return}else{if(h.data.playPaused&&(h.data.nextSlide-1)>0){f.data(h,"playPaused",false);h.start()}}f.data(h,"nextSlide",i);return this._slide()},next:function(){var h,i;h=this;f.data(h,"slideDirection","next");i=(h.data.nextSlide+1)%h.data.totalslides;if(!h.config.repeat&&(h.data.nextSlide+1)>(h.data.totalslides-1)){if(!h.config.playReverse){f.data(h,"playPaused",true);h.stop()}return}else{if(h.data.playPaused&&(h.data.nextSlide+1)<(h.data.totalslides-1)){f.data(h,"playPaused",false);h.start()}}f.data(h,"nextSlide",i);return this._slide()},start:function(){var i,h,j;i=this;h=f(".slide-container",i.$elem);if(i.data.isPlaying&&i.data.playTimer){clearInterval(i.data.playTimer)}j=setInterval((function(){if(i.config.playReverse){i.previous()}else{i.next()}}),i.config.interval);f.data(i,"playTimer",j);if(i.config.hoverPause){h.unbind();h.hover(function(){f.data(i,"playPaused",true);return i.stop()},function(){f.data(i,"playPaused",false);return i.start()})}f.data(i,"isPlaying",true)},stop:function(){var i,h;i=this;h=f(".slide-container",i.$elem);clearInterval(i.data.playTimer);f.data(i,"playTimer",null);if(i.config.hoverPause&&!i.data.playPaused){h.unbind()}f.data(i,"isPlaying",false)},gotoSlide:function(m){var j,i,n,l,k,h;j=this;f.data(j,"nextSlide",(m)%j.data.totalslides);i=(m)%j.data.totalslides;f.data(j,"currentSlide",i);n=f(".slide-wrapper",j.$elem);l=n.children();k=n.children(":eq("+i+")");h=k.position().left;l.removeClass(j.config.activeSlideClass);k.addClass(j.config.activeSlideClass);if(j.config.animationCssTransitions&&j.data.browserEnginePrefix){j._transition((-h),0)}else{n.position().left=-h}j._alignSlides(h)},_manualInterference:function(){var h=this;if(h.data.isPlaying){h.stop();h.start()}},_prepareslides:function(){var l,n,m,j,k,h;l=this;n=f(".slide-wrapper",l.$elem);m=n.children();j=l.data.width;k=Math.floor(l.data.totalslides/2);h=0;m.each(function(){f(this).css({display:"block",left:j*h,zIndex:10});h++;if(l.config.repeat&&h>k){h=l.data.totalslides%2?-k:-(k-1)}})},_onKeyboardNav:function(j){var i,h;i=this;h=j.which;switch(h){case 37:i.previous();i._manualInterference();break;case 39:i.next();i._manualInterference();break}j.preventDefault()},_onMoveStart:function(h,j){var i=this;if(!i.data.isMoving){f.data(i,"touchTime",Number(new Date()))}f.data(i,"touchedX",h);f.data(i,"touchedY",j);f.data(i,"isMoving",true);if(i.data.isPlaying){f.data(i,"playPaused",true);i.stop()}},_onMove:function(o,n){var h,p,l,k,m,i,j;h=this;if(!h.data.isMoving){return}p=f(".slide-wrapper",h.$elem);f.data(h,"scrolling",Math.abs(o-h.data.touchedX)<Math.abs(n-h.data.touchedY));if(!h.data.scrolling&&!h.data.isAnimating){l=p.children(":eq("+h.data.nextSlide+")");k=l.position().left;m=h.data.browserEnginePrefix.css;i=o-h.data.touchedX;j=h.data.width*0.1;if(!h.config.repeat){if(h.data.currentSlide<=0&&-i<-j){i=j}else{if(h.data.currentSlide>=(h.data.totalslides-1)&&-i>j){i=-j}}}h._transition(-k+i,0)}},_onMoveEnd:function(){var l,n,m,i,k,h,j;l=this;n=f(".slide-wrapper",l.$elem);f.data(l,"justTouched",true);m=n.children(":eq("+l.data.nextSlide+")");i=m.position().left;k=l.data.width*0.5;h=l.data.width*0.1;j=(Number(new Date())-l.data.touchTime<250);if(!l.config.repeat&&(n.position().left<-(i)&&l.data.currentSlide>=(l.data.totalslides-1)||n.position().left>(-i)&&l.data.currentSlide<=0)){l._transition((-i),0.15)}else{if(n.position().left>(-i+k)||(n.position().left>(-i+h)&&j)){this.previous()}else{if(n.position().left<-(i+k)||(n.position().left<-(i+h)&&j)){this.next()}else{l._transition((-i),0.15)}}}l._alignSlides(i);f.data(l,"isMoving",false);f.data(l,"justTouched",false);if(l.data.playPaused){l.start()}},_alignSlides:function(r){var j,s,q,o,t,k,h,l,n,m,p;j=this;if(!j.config.repeat){return}s=f(".slide-wrapper",j.$elem);q=s.children();if(r===g){o=s.children(":eq("+j.data.nextSlide+")");r=o.position().left}r=Math.round(r,0);t=Math.ceil(j.data.totalslides/2);k=j.data.width;h=0;q.each(function(){var i=f(this).position().left;if(i>r-k){h++}});l=t-h;if(l<0){l=j.data.totalslides%2==0?l+1:l}for(n=0;n<Math.abs(l);n++){m=[].reduce.call(q,function(i,u){return f(i).offset().left<f(u).offset().left?i:u});p=[].reduce.call(q,function(i,u){return f(i).offset().left>f(u).offset().left?i:u});if(l>0){f(m).css("left",Math.round(f(p).position().left+k))}else{f(p).css("left",Math.round(f(m).position().left-k))}}},_slide:function(){var j,l,h,r,q,o,n,m,i,p,k;j=this;l=j.data.nextSlide;h=j.data.currentSlide;r=f(".slide-wrapper",j.$elem);q=r.children();o=r.children(":eq("+l+")");n=r.children(":eq("+h+")");m=j.config.activeSlideClass;i=j.data.width;p=Math.round(n.position().left);k=Math.round(o.position().left);q.removeClass(m);o.addClass(m);j._alignSlides(k);f.data(j,"isAnimating",true);if(j.config.animationCssTransitions&&j.data.browserEnginePrefix){j._transition((-k),(j.data.justTouched?0.5:1));r.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",function(){f.data(j,"currentSlide",l);r.unbind("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd")})}else{r.stop().animate({left:-k},j.config.animationDuration,function(){f.data(j,"currentSlide",l);f.data(j,"isAnimating",false);f.data(j,"justTouched",false)})}},_transition:function(i,k){var m,o,l,h,n,j;m=this;o=f(".slide-wrapper",m.$elem);if(k===g||k<0){k=1}l=m.data.browserEnginePrefix.css;h=l+"Transform";n=l+"TransitionDuration";j=l+"TransitionTimingFunction";o[0].style[n]=(m.config.animationDuration*k)+"ms";o[0].style[j]=m.config.animationTimingFunction;o[0].style[h]="translateX("+i+"px)";o.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",function(){f.data(m,"isAnimating",false);f.data(m,"justTouched",false);o.unbind("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd")})},_resize:function(){var l,h,j,i,k;l=this;if(l.data.isPlaying){f.data(l,"playPaused",true);l.stop()}h=l.$elem.width();j=l.config.height/l.config.width;i=h*j;f.data(l,"width",h);f(".slide",l.$elem).css({width:h,height:i});k=f(".slide-wrapper",l.$elem).children().height();f(".slide-wrapper",l.$elem).css({height:k});f(".slide-container",l.$elem).css({width:h,height:k});if(l.data.playPaused){f.data(l,"playPaused",false);l.start()}l._prepareslides();l.gotoSlide(l.data.currentSlide)},_getBrowserEnginePrefix:function(){var j,k,h;j="Transition";k=["Moz","Webkit","Khtml","O","ms"];h=0;while(h<k.length){if(typeof a.body.style[k[h]+j]==="string"){return{css:k[h]}}h++}return false}};c.defaults=c.prototype.defaults;f.fn.excoloSlider=function(h){return this.each(function(){new c(this,h).init()})}})(jQuery,window,document);